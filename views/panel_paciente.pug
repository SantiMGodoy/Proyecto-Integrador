extends layout

block content
  h2.text-center.mb-5.text-primary Resumen y gestiÃ³n del paciente: #{paciente.nombre}

  .card.shadow-sm.mb-4
    .card-body
      h4.border-bottom.pb-2.mb-3 Datos Personales
      ul.list-group.list-group-flush
        li.list-group-item.fw-semibold DNI: 
          span.fw-normal #{paciente.dni}
        li.list-group-item.fw-semibold Fecha de Nacimiento: 
          span.fw-normal #{paciente.fechaNacimiento ? paciente.fechaNacimiento.toISOString().split('T')[0] : '-'}
        li.list-group-item.fw-semibold Sexo: 
          span.fw-normal #{paciente.sexo}
        li.list-group-item.fw-semibold TelÃ©fono: 
          span.fw-normal #{paciente.telefono}
        li.list-group-item.fw-semibold DirecciÃ³n: 
          span.fw-normal #{paciente.direccion}
        li.list-group-item.fw-semibold Obra Social: 
          span.fw-normal #{paciente.obraSocial}
        - const via = paciente.viaIngreso === 'programada' ? 'Cita programada' : paciente.viaIngreso === 'derivacion' ? 'DerivaciÃ³n mÃ©dica' : paciente.viaIngreso === 'emergencia' ? 'Emergencia' : 'No especificada';
        li.list-group-item.fw-semibold VÃ­a de ingreso: 
          span.fw-normal #{via}
        if paciente.medicoDerivante
          li.list-group-item.fw-semibold MÃ©dico derivante: 
            span.fw-normal #{paciente.medicoDerivante}

  if paciente.viaIngreso === 'emergencia'
    .alert.alert-warning.mt-2
      strong âš  AtenciÃ³n:
      |  El paciente ingresÃ³ por emergencia. Solo se registraron los datos bÃ¡sicos y su internaciÃ³n.

  .card.shadow-sm.mb-4
    .card-body
      h4.border-bottom.pb-2.mb-3 Evaluaciones

      if evaluacionEnfermeria
        h5.text-success.mt-3 ğŸ‘©â€âš•ï¸ EnfermerÃ­a
        ul.list-group.list-group-flush.mb-3
          li.list-group-item Enfermedades Previas: #{evaluacionEnfermeria.enfermedadesPrevias}
          li.list-group-item CirugÃ­as: #{evaluacionEnfermeria.cirugias}
          li.list-group-item Alergias: #{evaluacionEnfermeria.alergias}
          li.list-group-item MedicaciÃ³n Actual: #{evaluacionEnfermeria.medicacionActual}
          li.list-group-item Motivo de InternaciÃ³n: #{evaluacionEnfermeria.motivoInternacion}
          li.list-group-item SÃ­ntomas: #{evaluacionEnfermeria.sintomas}
          li.list-group-item PresiÃ³n: #{evaluacionEnfermeria.presion}
          li.list-group-item Frecuencia CardÃ­aca: #{evaluacionEnfermeria.frecuenciaCardiaca}
          li.list-group-item Frecuencia Respiratoria: #{evaluacionEnfermeria.frecuenciaRespiratoria}
          li.list-group-item Temperatura: #{evaluacionEnfermeria.temperatura}
          li.list-group-item Plan de Cuidados: #{evaluacionEnfermeria.planCuidados}
      else
        p.text-muted No se encontrÃ³ evaluaciÃ³n de enfermerÃ­a.

      if evaluacionMedica
        h5.text-primary.mt-4 ğŸ‘¨â€âš•ï¸ MÃ©dica
        ul.list-group.list-group-flush
          li.list-group-item DiagnÃ³stico: #{evaluacionMedica.diagnostico}
          li.list-group-item Tratamientos: #{evaluacionMedica.tratamientos}
          li.list-group-item MedicaciÃ³n: #{evaluacionMedica.medicacion}
          li.list-group-item Estudios solicitados: #{evaluacionMedica.estudiosSolicitados}
          li.list-group-item Observaciones: #{evaluacionMedica.observaciones}
      else
        p.text-muted No se encontrÃ³ evaluaciÃ³n mÃ©dica.

  .card.shadow-sm.mb-4
    .card-body
      h4.border-bottom.pb-2.mb-3 Estado de Cama
      if cama
        ul.list-group.list-group-flush
          li.list-group-item Cama: #{cama.numero}
          li.list-group-item HabitaciÃ³n: #{cama.Habitacion.numero}
          li.list-group-item Ala: #{cama.Habitacion.Ala.nombre}
          li.list-group-item Tipo: #{cama.Habitacion.tipo}
          li.list-group-item Â¿InternaciÃ³n?: #{cama.Habitacion.requiereInternacion ? 'SÃ­' : 'No'}
      else
        p.text-muted No tiene cama asignada actualmente.

      if internacion
        if internacion.fechaAlta
          p.mt-2.text-success Fue dado de alta el #{internacion.fechaAlta.toISOString().split('T')[0]}
        else
          form.d-inline(action=`/internacion/alta/${paciente.id}` method="POST" onsubmit="return confirm('Â¿Confirmar alta del paciente?');")
            button.btn.btn-success.mt-2(type="submit") âœ… Dar de alta

          form.d-inline(action=`/internacion/cancelar/${paciente.id}` method="POST" onsubmit="return confirm('Â¿Cancelar internaciÃ³n?');")
            button.btn.btn-outline-danger.mt-2.ms-2(type="submit") âŒ Cancelar internaciÃ³n
      else if cama && !cama.Habitacion.requiereInternacion
        form.d-inline(action=`/internacion/finalizar/${cama.id}` method="POST" onsubmit="return confirm('Â¿Finalizar turno y liberar cama?');")
          button.btn.btn-success.mt-2(type="submit") âœ… Finalizar turno

        form.d-inline(action=`/internacion/finalizar/${cama.id}` method="POST" onsubmit="return confirm('Â¿Cancelar turno y liberar cama?');")
          button.btn.btn-outline-danger.mt-2.ms-2(type="submit") âŒ Cancelar turno

  hr

  h4.mt-4.mb-3 Opciones RÃ¡pidas
  .row.text-center
    .col-md-4.mb-3
      .card.shadow-sm
        .card-body
          h5.card-title ğŸ›ï¸ Asignar cama
          a.btn.btn-primary.mt-2(href=`/internacion/asignar/${paciente.id}`) Ir

    .col-md-4.mb-3
      .card.shadow-sm
        .card-body
          h5.card-title ğŸ‘©â€âš•ï¸ EvaluaciÃ³n de enfermerÃ­a
          if paciente.viaIngreso === 'emergencia'
            p.text-muted (opcional)
          a.btn.btn-success.mt-2(href=`/enfermeria/registrar/${paciente.id}`) Ir

    .col-md-4.mb-3
      .card.shadow-sm
        .card-body
          h5.card-title ğŸ‘¨â€âš•ï¸ EvaluaciÃ³n mÃ©dica
          if paciente.viaIngreso === 'emergencia'
            p.text-muted (opcional)
          a.btn.btn-info.mt-2(href=`/medica/registrar/${paciente.id}`) Ir

  .row.text-center.mt-4
    .col-md-6.offset-md-3
      .card.shadow-sm
        .card-body
          h5.card-title ğŸ›ï¸ Ver estado de camas
          p.text-muted Ver disponibilidad general del hospital
          a.btn.btn-outline-info.mt-2(href="/internacion/camas") Ver camas

  a.btn.btn-outline-secondary.mt-5(href="/") â¬…ï¸ Volver al inicio
